<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_relationship">
    <sys_relationship action="INSERT_OR_UPDATE">
        <advanced>true</advanced>
        <apply_to>answer = true;</apply_to>
        <basic_apply_to>sys_user_group</basic_apply_to>
        <basic_query_from>x_pd_integration_map_priority_to_ep</basic_query_from>
        <insert_callback>if (!current.priority) {
  var gr = new GlideRecordSecure('sys_user_group');
  if (gr.get(current.assignment_group)) {
    var epHelper = new x_pd_integration.EscalationPolicyHelper();
    var existingEpName = epHelper.getEpNameById(gr.x_pd_integration_pagerduty_escalation);
    if (existingEpName)
      gs.addInfoMessage('A new record with escalation policy [&lt;b&gt;'
        + current.escalation_policy.escalation_policy_name
        + '&lt;/b&gt;] will override the existing one [&lt;b&gt;' + existingEpName + '&lt;/b&gt;].');
    gr.setValue('x_pd_integration_pagerduty_escalation', current.escalation_policy.escalation_policy_id);
    gr.update();
    epHelper.removeObsoleteDefaultRows(current.sys_id, current.assignment_group);
  }
}
</insert_callback>
        <name>PagerDuty Escalation Policies</name>
        <query_from>answer = 'x_pd_integration_map_priority_to_ep';</query_from>
        <query_with>(function refineQuery(current, parent) {

	// Add your code here, such as current.addQuery(field, value);

	current.addQuery('assignment_group', parent.sys_id);
	current.addNotNullQuery('priority');

})(current, parent);</query_with>
        <reference_field>assignment_group</reference_field>
        <related_list/>
        <simple_reference>false</simple_reference>
        <sys_class_name>sys_relationship</sys_class_name>
        <sys_created_by>PagerDuty_v8.0</sys_created_by>
        <sys_created_on>2020-07-02 11:25:56</sys_created_on>
        <sys_id>4b0718cddbb110103541d426ca9619bf</sys_id>
        <sys_mod_count>34</sys_mod_count>
        <sys_name>PagerDuty Escalation Policies</sys_name>
        <sys_package display_value="PagerDuty Incident Resolution Platform" source="x_pd_integration">39a9d9664f834e00dd657bb28110c77b</sys_package>
        <sys_policy/>
        <sys_scope display_value="PagerDuty Incident Resolution Platform">39a9d9664f834e00dd657bb28110c77b</sys_scope>
        <sys_update_name>sys_relationship_4b0718cddbb110103541d426ca9619bf</sys_update_name>
        <sys_updated_by>PagerDuty_v8.0</sys_updated_by>
        <sys_updated_on>2020-07-08 13:20:03</sys_updated_on>
    </sys_relationship>
    <sys_translated_text action="delete_multiple" query="documentkey=4b0718cddbb110103541d426ca9619bf"/>
    <sys_ui_related_list_relationship_entry action="INSERT_OR_UPDATE">
        <filter/>
        <list_id display_value="Group - Default view" name="sys_user_group" related_list="NULL" sys_domain="global" view="Default view">c3874291983100107f2c2ed01a1f168c</list_id>
        <order_by/>
        <position>3</position>
        <related_list>REL:4b0718cddbb110103541d426ca9619bf</related_list>
        <sys_class_name>sys_ui_related_list_relationship_entry</sys_class_name>
        <sys_created_by>PagerDuty_v8.0</sys_created_by>
        <sys_created_on>2020-07-02 11:25:56</sys_created_on>
        <sys_id>9cc954cddbb110103541d426ca961991</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_relationship display_value="PagerDuty Escalation Policies">4b0718cddbb110103541d426ca9619bf</sys_relationship>
        <sys_ui_related_list display_value="Group - Default view" name="sys_user_group" related_list="NULL" sys_domain="global" view="Default view">c3874291983100107f2c2ed01a1f168c</sys_ui_related_list>
        <sys_updated_by>PagerDuty_v8.0</sys_updated_by>
        <sys_updated_on>2020-07-02 11:25:56</sys_updated_on>
    </sys_ui_related_list_relationship_entry>
</record_update>
